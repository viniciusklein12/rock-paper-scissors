<!DOCTYPE html>
<html>
<head>
    <title>Rock, paper, scissors</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
</head>
<body>
    <div class="container" style="margin-top: 100pt;">
        <div class="row">
            <div class="col s12 center">
                <button class="waves-effect waves-light btn" id="start">Start Game</button>
            </div>
        </div>
    
    <div id="game" class="row" style="opacity: 0">

        <div class="col s12 center">
            <p>Computer selection:</p>
            <p id="computer-selection"></p>
        </div>

        <div class="row">
            <div class="col s4 center">
                <button class="waves-effect waves-light btn" id="rock">Rock</button>
            </div>
            <div class="col s4 center">
                <button class="waves-effect waves-light btn" id="paper">Paper</button>
            </div>
            <div class="col s4 center">
                <button class="waves-effect waves-light btn" id="scissors">Scissors</button>
            </div>
        </div>
        <div class="row">
            <div class="col s6 center">
                <p>Player</p>
                <p id="player-result"></p>
            </div>
            <div class="s6 center">
                <p>Computer</p>
                <P id="computer-result"></P>
            </div>
        </div>
    </div>
</div>
</body>
<script>
    const computerSelectionDisplay = document.getElementById('computer-selection');
    const startGameButton = document.getElementById('start');
    const rockButton = document.getElementById('rock');
    const paperButton = document.getElementById('paper');
    const scissorsButton = document.getElementById('scissors');
    const playerResult = document.getElementById('player-result');
    const computerResult = document.getElementById('computer-result');
    const gameElement = document.getElementById('game')

    const computerPlay = () => {
        let rng = Math.random()
        if (rng <= 1/3){
            return 'Rock'
        }
        else if (rng > 1/3 && rng <= 2/3 ){
            return 'Paper'
        } else {
            return 'Scissors'
        }
    }

    const playRound = (playerSelection, computerSelection) => {
        let playerSelectionLowercase = playerSelection.toLowerCase();
        let computerSelectionLowercase = computerSelection.toLowerCase();
        let result = {player: 0, computer: 0};

        if (playerSelectionLowercase == computerSelectionLowercase) {
            return result
        }
        else if (
            playerSelectionLowercase == 'rock' && computerSelectionLowercase == 'paper' ||
            playerSelectionLowercase == 'paper' && computerSelectionLowercase == 'scissors' ||
            playerSelectionLowercase == 'scissors' && computerSelectionLowercase == 'rock'
        ){
            result.computer = 1
            return result
        }
        else if (
            playerSelectionLowercase == 'rock' && computerSelectionLowercase == 'scissors' ||
            playerSelectionLowercase == 'paper' && computerSelectionLowercase == 'rock' ||
            playerSelectionLowercase == 'scissors' && computerSelectionLowercase == 'paper'
            ){
            result.player = 1
            return result
        }
        }

    const gameRound = (playerSelection, computerSelection) => {
        let roundResult;
        roundResult = playRound(playerSelection, computerSelection);
        playerResult.textContent = parseInt(playerResult.textContent) + roundResult.player;
        computerResult.textContent = parseInt(computerResult.textContent) + roundResult.computer;
        if (parseInt(playerResult.textContent) + parseInt(computerResult.textContent) == 5){
            let finalResult = {player: parseInt(playerResult.textContent), computer: parseInt(computerResult.textContent)}
            endGame(finalResult);
            return
    }
    }

    const endGame = (finalResult) => {
        
        if (finalResult.player > finalResult.computer) {
            alert("You Won!")
        } else {
            alert("You Lost!")
        }
        location.reload();
        return false;
    }

    const game = (computerSelection) => {
        let roundResult;

        rockButton.onclick = () => {
            gameRound('rock', computerSelection);
            computerSelection = computerPlay();
            computerSelectionDisplay.textContent = computerSelection;
        }
        paperButton.onclick = () => {
            gameRound('paper', computerSelection);
            computerSelection = computerPlay();
            computerSelectionDisplay.textContent = computerSelection;
        }
        scissorsButton.onclick = () => {
            gameRound('scissors', computerSelection);
            computerSelection = computerPlay();
            computerSelectionDisplay.textContent = computerSelection;
        }
    }

    startGameButton.onclick = () => {
        gameElement.style.opacity = "1"
        let computerSelection = computerPlay();
        computerSelectionDisplay.textContent = computerSelection;
        playerResult.textContent = 0;
        computerResult.textContent = 0;
        game(computerSelection);
}

</script>

</html>